import{B as A,C as F,x as T,y as L}from"./chunk-LHDBUF4B.js";import{$ as x,A as b,Aa as S,Ba as E,Ea as j,F as g,Fa as M,G as h,Ka as O,N as C,O as o,P as u,T as _,V as s,X as i,Y as r,Z as I,_ as v,aa as m,ca as p,ea as d,ja as y,ka as w,o as f,u as P,x as k}from"./chunk-KUFX4WSM.js";var l=class n{constructor(e){this.http=e}loadPokemones(){return this.http.get("https://pokeapi.co/api/v2/pokemon?limit=150").pipe(f(e=>e.results.map((t,a)=>({id:a+1,name:t.name,image:`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${a+1}.png`}))))}static \u0275fac=function(t){return new(t||n)(k(M))};static \u0275prov=P({token:n,factory:n.\u0275fac,providedIn:"root"})};function H(n,e){if(n&1&&I(0,"img",6),n&2){let t=m();s("src",t.randomPokemon==null?null:t.randomPokemon.image,C)}}function N(n,e){if(n&1){let t=v();i(0,"button",9),x("click",function(){let c=g(t).$implicit,R=m(2);return h(R.handleGuess(c))}),p(1),r()}if(n&2){let t=e.$implicit;o(),d(" ",t," ")}}function G(n,e){if(n&1&&(i(0,"div",7),_(1,N,2,1,"button",8),r()),n&2){let t=m();o(),s("ngForOf",t.options)}}function $(n,e){if(n&1&&(i(0,"h4"),p(1),r()),n&2){let t=m();o(),d("Intentos restantes: ",t.attemptsLeft,"")}}function q(n,e){if(n&1&&(i(0,"h4"),p(1),r()),n&2){let t=m();o(),d("Aciertos: ",t.score,"")}}function J(n,e){n&1&&(i(0,"h4"),p(1,"Se han agotado tus intentos."),r())}function U(n,e){if(n&1&&(i(0,"h4"),p(1),r()),n&2){let t=m(2);o(),d("Puntaje final: ",t.score,"")}}function W(n,e){n&1&&(i(0,"h4"),p(1,"Acertaste los 151 pokemons. Muy bien! "),r())}function Y(n,e){if(n&1&&(i(0,"h4"),p(1),r()),n&2){let t=m(2);o(),d("Te quedaron ",t.attemptsLeft," intentos")}}function B(n,e){if(n&1){let t=v();i(0,"div",10)(1,"div",11),_(2,J,2,0,"h4",4)(3,U,2,1,"h4",4)(4,W,2,0,"h4",4)(5,Y,2,1,"h4",4),i(6,"button",12),x("click",function(){g(t);let c=m();return h(c.resetGame())}),p(7,"Jugar de nuevo"),r(),i(8,"button",12),x("click",function(){g(t);let c=m();return h(c.volverAlInicio())}),p(9,"Volver al inicio"),r()()()}if(n&2){let t=m();o(2),s("ngIf",t.attemptsLeft<=0),o(),s("ngIf",t.attemptsLeft<=0),o(),s("ngIf",t.attemptsLeft>0),o(),s("ngIf",t.attemptsLeft>0)}}var V=class n{constructor(e,t,a,c){this.preguntadosService=e;this.router=t;this.firestore=a;this.auth=c}pokemones=[];usedPokemons=new Set;randomPokemon;options=[];attemptsLeft=3;score=0;gameEnded=!1;userEmail;ngOnInit(){this.preguntadosService.loadPokemones().subscribe(e=>{this.pokemones=e,this.showRandomPokemon()}),this.auth.isLoggedIn().pipe(f(e=>({loggedIn:!!e,email:e?e.email:null}))).subscribe(({email:e})=>{this.userEmail=e})}showRandomPokemon(){if(this.usedPokemons.size>=this.pokemones.length||this.attemptsLeft<=0){this.gameEnded=!0;return}let e;do e=Math.floor(Math.random()*this.pokemones.length);while(this.usedPokemons.has(this.pokemones[e].id));this.randomPokemon=this.pokemones[e],this.usedPokemons.add(this.randomPokemon.id),this.generateOptions()}generateOptions(){for(this.options=[this.randomPokemon.name];this.options.length<4;){let e=Math.floor(Math.random()*this.pokemones.length),t=this.pokemones[e].name;this.options.includes(t)||this.options.push(t)}this.options=this.shuffleArray(this.options)}shuffleArray(e){return e.sort(()=>Math.random()-.5)}handleGuess(e){this.gameEnded||(e===this.randomPokemon.name?this.score++:this.attemptsLeft--,this.attemptsLeft>0?this.showRandomPokemon():(this.gameEnded=!0,this.guardarPuntaje()))}resetGame(){this.usedPokemons.clear(),this.attemptsLeft=3,this.score=0,this.gameEnded=!1,this.showRandomPokemon()}volverAlInicio(){this.router.navigate(["/home"])}guardarPuntaje(){let e=F(this.firestore,"puntajes");A(e,{usuario:this.userEmail,puntaje:this.score,fecha:new Date,juego:"preguntados"})}static \u0275fac=function(t){return new(t||n)(u(l),u(O),u(L),u(T))};static \u0275cmp=b({type:n,selectors:[["app-preguntados"]],standalone:!0,features:[y([l]),w],decls:9,vars:5,consts:[[1,"wrapper"],[1,"game-container"],["class","imagen-agrandada",3,"src",4,"ngIf"],["class","buttons",4,"ngIf"],[4,"ngIf"],["class","modal",4,"ngIf"],[1,"imagen-agrandada",3,"src"],[1,"buttons"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"modal"],[1,"modal-content"],[1,"modal-button",3,"click"]],template:function(t,a){t&1&&(i(0,"div",0)(1,"div",1)(2,"h2"),p(3,"Preguntados Pokemon"),r(),_(4,H,1,1,"img",2)(5,G,2,1,"div",3)(6,$,2,1,"h4",4)(7,q,2,1,"h4",4)(8,B,10,4,"div",5),r()()),t&2&&(o(4),s("ngIf",a.randomPokemon),o(),s("ngIf",a.options.length>0),o(),s("ngIf",!a.gameEnded),o(),s("ngIf",!a.gameEnded),o(),s("ngIf",a.gameEnded))},dependencies:[j,S,E],styles:['.game-container[_ngcontent-%COMP%]{text-align:center;font-family:Arial,sans-serif;height:73vh;width:150vh;border:10px solid rgb(137,142,148);background-color:#fff;box-shadow:0 0 15px #0000004d;overflow:auto}h4[_ngcontent-%COMP%]{font-size:20px;color:#333}h2[_ngcontent-%COMP%]{color:#4caf50}.wrapper[_ngcontent-%COMP%]{background-image:url("./media/fondo4-VYWSDTRN.jpg");height:90vh;display:flex;justify-content:center;align-items:center}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000000b3;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:8px;text-align:center}.modal-button[_ngcontent-%COMP%]{margin:10px}.imagen-agrandada[_ngcontent-%COMP%]{width:350px;height:350px}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:15px;margin-top:20px}button[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;border:none;border-radius:5px;padding:10px 15px;font-size:16px;cursor:pointer;transition:background-color .3s}button[_ngcontent-%COMP%]:hover{background-color:#45a049}']})};export{V as PreguntadosComponent};
